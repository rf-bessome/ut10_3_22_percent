
Функция СтатусДокументооборота(Ссылка) Экспорт
	
	Результат = ЭлектронныеДокументыСлужебный.ПолучитьСтруктуруВерсииЭД(Ссылка);
	Результат.Вставить("ЭлектронныйДокумент", Результат.СсылкаНаДокумент);
	Результат.Вставить("Статус",              "НеНачат");
	
	Если Не ЗначениеЗаполнено(Результат.ЭлектронныйДокумент) Тогда 
		Результат.ЭлектронныйДокумент = Неопределено;
	КонецЕсли;
	
	СостояниеВерсииЭлектронногоДокумента = Результат.СостояниеВерсииЭД;
	// Переведем статус в "простую" классификацию.
	Если СостояниеВерсииЭлектронногоДокумента = Перечисления.СостоянияВерсийЭД.Аннулирован
		ИЛИ СостояниеВерсииЭлектронногоДокумента = Перечисления.СостоянияВерсийЭД.ЗакрытПринудительно
		ИЛИ СостояниеВерсииЭлектронногоДокумента = Перечисления.СостоянияВерсийЭД.ОбменЗавершенСИсправлением
		ИЛИ СостояниеВерсииЭлектронногоДокумента = Перечисления.СостоянияВерсийЭД.ОжидаетсяКорректировка
		ИЛИ СостояниеВерсииЭлектронногоДокумента = Перечисления.СостоянияВерсийЭД.Отклонен
		ИЛИ СостояниеВерсииЭлектронногоДокумента = Перечисления.СостоянияВерсийЭД.ТребуетсяУточнитьДокумент Тогда
		
		Результат.Статус = "Отклонен";
	ИначеЕсли СостояниеВерсииЭлектронногоДокумента = Перечисления.СостоянияВерсийЭД.ИзвещениеНаПодписи
		ИЛИ СостояниеВерсииЭлектронногоДокумента = Перечисления.СостоянияВерсийЭД.ОбменЗавершен
		ИЛИ СостояниеВерсииЭлектронногоДокумента = Перечисления.СостоянияВерсийЭД.ОжидаетсяИзвещениеОПолучении
		ИЛИ СостояниеВерсииЭлектронногоДокумента = Перечисления.СостоянияВерсийЭД.ОжидаетсяОтправкаИзвещения Тогда
		
		Результат.Статус = "Утвержден";
	ИначеЕсли СостояниеВерсииЭлектронногоДокумента = Перечисления.СостоянияВерсийЭД.НаПодписи
		ИЛИ СостояниеВерсииЭлектронногоДокумента = Перечисления.СостоянияВерсийЭД.ОжидаетсяПередачаОператору Тогда
		
		Результат.Статус = "ВОбработке";
		
	ИначеЕсли СостояниеВерсииЭлектронногоДокумента = Перечисления.СостоянияВерсийЭД.ОжидаетсяОтправка
		ИЛИ СостояниеВерсииЭлектронногоДокумента = Перечисления.СостоянияВерсийЭД.ОжидаетсяОтправкаПолучателю Тогда
		
		Результат.Статус = "ВОбработке";
		
	ИначеЕсли СостояниеВерсииЭлектронногоДокумента = Перечисления.СостоянияВерсийЭД.ОжидаетсяПодтверждение Тогда
		
		Результат.Статус = "Утвержден";
		
	ИначеЕсли СостояниеВерсииЭлектронногоДокумента = Перечисления.СостоянияВерсийЭД.НаУтверждении Тогда
		
		Результат.Статус = "Получен";
	ИначеЕсли СостояниеВерсииЭлектронногоДокумента = Перечисления.СостоянияВерсийЭД.НеПолучен
		ИЛИ СостояниеВерсииЭлектронногоДокумента = Перечисления.СостоянияВерсийЭД.НеСформирован Тогда
		
		Результат.Статус = "НеНачат";
	ИначеЕсли СостояниеВерсииЭлектронногоДокумента = Перечисления.СостоянияВерсийЭД.ОжидаетсяАннулирование
		ИЛИ СостояниеВерсииЭлектронногоДокумента = Перечисления.СостоянияВерсийЭД.ТребуетсяАннулировать Тогда
	
		Результат.Статус = "ОтклонениеВОбработке";
	ИначеЕсли СостояниеВерсииЭлектронногоДокумента = Перечисления.СостоянияВерсийЭД.ОшибкаПередачи Тогда
		
		Результат.Статус = "Ошибка";
	ИначеЕсли СостояниеВерсииЭлектронногоДокумента = Перечисления.СостоянияВерсийЭД.ПустаяСсылка() Тогда
		
		Результат.Статус = "ЭДОНеНастроен";
	КонецЕсли;
	
	Возврат Результат;
	
КонецФункции

Функция ЕстьПравоОбработкиЭД() Экспорт 
	
	Возврат ПравоДоступа("Просмотр", Метаданные.Обработки.ТекущиеДелаПоЭДО);
	
КонецФункции

/////////////////////////////////////////////////////////////////////////
// Требуется встраивание для блока проверки документа на требования ГИСМТ
// Заглушка
//
Функция СведенияОбЭлектронномДокументе(ЭлектронныйДокумент) Экспорт
	
	Результат = Новый Структура;
	Результат.Вставить("ОбъектыУчета", Новый Массив);
	Возврат Результат;
	
КонецФункции

Функция НастройкиОтправки(Документы) Экспорт 
	
	Результат = Новый Соответствие;
	Возврат Результат;
	
КонецФункции
